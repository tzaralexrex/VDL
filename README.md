# VDL
Universal video downloader

Универсальный загрузчик видео с различных сайтов.  
Фактически - "обёртка" к yt-dlp, соответственно, теоретически поддерживает все сайты, которые умеет обрабатывать yt-dlp (https://github.com/yt-dlp/yt-dlp/blob/master/supportedsites.md).  Кроме того, если сайт не указан в поддерживаемых, скрипт всё равно способен в простых случаях найти внедрённое на страничке видео и попытаться его скачать, используя generic-режим yt-dlp.  
Авторизация на сайтах - с помощью cookie из браузера. Желательно сохранить их отдельно в формате Netscape.  
Требует для работы, разумеется, импорт yt-dlp и ещё нескольких библиотек (импортирует их автоматически), а также ffmpeg рядом или по системному пути.  
Добавлен скрипт нормализации субтитров Youtube - nys.py  
Сейчас - в виде самодостаточного скрипта. Нормализует .srt-файл, переданный ему в аргументах, либо все файлы .srt в текущей папке (при запуске с ключом -a) или рекурсивно во всех подпапках (с ключом -r)  
Автоматические субтитры Youtube делает с совершенно инопланетными таймингами, вынуждая полностью концентрировать внимание на субтитрах, чтобы понять, какой титр читать. Скрипт делает нормальные двустрочные субтитры без перемешивания строк и эффекта телетайпа.  

Управляющие переменные и пути - в начале скрипта после блока импортов, при желании можно править.  

DEBUG = 1  # Глобальная переменная для включения/выключения отладки (1/0)  
DEBUG_FILE = 'debug.log' # Имя файла журнала отладки  
DEBUG_APPEND = 1 # 0 = перезаписывать лог при каждом запуске, 1 = дописывать к существующему логу  
MAX_RETRIES = 15  # Максимум попыток повторной загрузки при обрывах  
CHECK_VER = 1  # 1 = проверять версии зависимостей, 0 = только наличие модулей  
В аргументах функции import_or_update флаг force_check, при установке в True функция игнорирует флаг CHECK_VER для данного вызова:  
    yt_dlp = import_or_update('yt_dlp', force_check=True) - этот модуль часто обновляется, в связи с изменениями требований видеосервисов  
InitialDir = "Video"  # относительный путь к подпапке Video в текущей директории для автоматического выбора папки скачивания  
PAGE_SIZE = 20    # количество видео на одной странице при выводе плейлиста  
PAGE_TIMEOUT = 10 # таймаут ожидания (секунд) между страницами плейлиста  
Скрипт понимает передачу ссылки в командной строке. Желательно ссылку обёртывать кавычками, иначе система может посчитать аргументы ссылки за аргументы вызова:  
    vdl.py "ссылка"  
При выборе позиций плейлиста для скачивания скрипт понимает диапазоны номеров и конечный открытый диапазон, например, если в плейлисте 30 файлов, а при запросе задано:  
1 3 4, 7-10, 15, 27-  
то скрипт скачает видео с номерами 1, 3, 4, 7, 8, 9, 10, 15, 27, 28, 29, 30  
При нахождении открытого диапазона не на последнем месте скрипт пытается его распознать как закрытый, используя следующее число, как конец диапазона.  
При запросе имени файла скрипт копирует предлагаемое имя в буфер обмена, чтобы его можно было вставить и поправить - удобно, когда надо внести минимальные изменения в имя, чтобы не набивать руками или не копировать специально  
При выборе выходного формата mkv скрипт предложит интегрировать скачанные субтитры и главы внутрь контейнера.  

